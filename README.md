# Neural ODE for ICU Mortality Prediction

Applying Latent ODEs to irregular clinical time series from the PhysioNet 2012 Challenge dataset to predict in-hospital mortality.

## Motivation

ICU patient data is naturally irregular — vitals and labs are recorded at uneven intervals, and patients have vastly different observation patterns. Standard RNNs struggle with this. Neural ODEs model the underlying continuous-time dynamics directly, making them a natural fit.

This project implements the Latent ODE approach from [Rubanova et al. (2019)](https://arxiv.org/abs/1907.03907), applied to the PhysioNet 2012 ICU dataset.

## Dataset

**PhysioNet Computing in Cardiology Challenge 2012**
- 12,000 ICU patients (sets A, B, C — 4,000 each)
- 48-hour observation window
- 37 irregularly sampled clinical variables (HR, GCS, RespRate, etc.)
- Target: in-hospital mortality (binary)

Data available at: https://physionet.org/content/challenge-2012/1.0.0/

## Model Architecture

```
Observations (irregular) --> RNN Encoder (backwards) --> z0 (latent initial state)
                                                              |
                                                         Latent ODE
                                                         (Neural ODE)
                                                              |
                                                         Decoder --> Mortality prediction
```

- **Encoder**: Bidirectional GRU processes observed values + timestamps
- **Latent ODE**: ODE function modeled by an MLP, solved with `torchdiffeq`
- **Decoder**: Linear layer maps latent state to mortality probability

## Project Structure

```
neural-ode-icu/
├── data/
│   ├── raw/          # PhysioNet 2012 files (not committed)
│   └── processed/    # Preprocessed tensors (generated by dataset.py)
├── src/
│   ├── dataset.py    # Data loading, preprocessing, PyTorch Dataset
│   ├── model.py      # Latent ODE model
│   └── train.py      # Training + evaluation loop
├── notebooks/        # EDA and result visualization
├── results/          # Training curves, metrics, plots
└── requirements.txt
```

## Setup

```bash
pip install -r requirements.txt
```

## Usage

```bash
# Preprocess data
python src/dataset.py

# Train model
python src/train.py

# Train with custom settings
python src/train.py --epochs 50 --batch-size 64 --latent-dim 32
```

## Results

| Metric | Value |
|--------|-------|
| AUROC  | TBD   |
| AUPRC  | TBD   |

*(Training in progress)*

## References

- Rubanova, Y., Chen, T. Q., & Duvenaud, D. (2019). Latent ODEs for Irregularly-Sampled Time Series. NeurIPS 2019.
- Chen, T. Q., et al. (2018). Neural Ordinary Differential Equations. NeurIPS 2018.
- PhysioNet Challenge 2012: https://physionet.org/content/challenge-2012/
